# XPouch AI 项目记忆（Memory）

本文档记录项目的重要变更、决策和里程碑。

---

## 2026-01-23：前端依赖升级到最新稳定版本

### 🔧 更新内容

**前端核心依赖升级**：
- **Vite**: 从 ^5.4.17 升级到 **^7.3.1**（5.x → 7.x 重大版本更新）
- **Framer Motion**: 从 ^11.15.0 升级到 **^12.29.0**（11.x → 12.x 重大版本更新）
- **Lucide React**: 从 ^0.462.0 升级到 **^0.563.0**（0.46 → 0.56 版本）

**开发者工具更新**：
- **@vitejs/plugin-react**: 从 ^4.3.4 升级到 **^5.1.2**（支持 Vite 7）
- **@sentry/react**: 从 ^10.33.0 升级到 **^10.36.0**
- **@sentry/vite-plugin**: 从 ^4.6.1 升级到 **^4.7.0**
- **@testing-library/react**: 从 ^16.3.1 升级到 **^16.3.2**
- **@types/node**: 从 ^25.0.7 升级到 **^25.0.10**

### 🔧 配置修复

**pnpm workspace 配置**：
- 创建 `pnpm-workspace.yaml` 文件
- 配置仅包含 `frontend` 包（保持 Monorepo 结构）
- 解决 pnpm 的 workspace 警告

**依赖位置清理**：
- 从根目录 `package.json` 移除前端依赖
- 确保前端包独立管理自己的依赖
- 保持项目结构清晰

### ✅ 验证结果

**构建测试**：
- ✅ Vite 7.3.1 构建成功
- ✅ 无编译错误或警告
- ✅ 所有功能运行正常

**关键指标**：
- **构建时间**: 6.19秒
- **包大小**: 主 chunk 1.05 MB（合理范围）
- **兼容性**: Node 22 + React 18 完全支持

### 🚀 升级评估

**React 19 升级可行性**：
- ✅ 代码模式兼容（函数组件 + hooks）
- ⚠️ 需要检查第三方库支持
- 🔶 建议暂不升级（React 18 稳定，收益有限）

**Vite 7 + Tailwind CSS 4**：
- ✅ **Vite 7.3.1 已升级**（构建成功）
- 🟡 Tailwind CSS 4 仍处于 Alpha（不推荐生产使用）

### 📊 项目状态

- **前后端架构**: ✅ 健康（Monorepo 结构正确）
- **依赖版本**: ✅ 最新稳定版
- **构建系统**: ✅ Vite 7 运行正常
- **Workspace 配置**: ✅ 无警告

---

## 项目架构里程碑

### 2026-01-22：XPouch AI 架构重构完成
完成7个阶段的重构项目，实现前后端统一架构，支持三种会话类型（default/custom/ai），Artifacts统一处理，简单和复杂双模式运行稳定。

### 2026-01-21：性能优化与交互改进
- FloatingExpertBar 从 112 个 DOM 元素优化到 7 个
- 移除布局动画和 motion 组件
- 聊天消息悬停显示操作按钮
- Artifact 标题支持自定义

### 2026-01-20：专家协作可视化系统
移除 InteractiveCanvas 中间层，改为 XPouchLayout 三区扁平布局（专家状态栏 + artifact + 对话面板），实现专家执行过程可视化。

---

## 技术决策

### 依赖管理策略
- **前端**: pnpm + workspace 配置
- **后端**: uv（Python 包管理器）
- **数据库**: SQLModel（SQLite + ORM）

### 架构设计
- **前后端分离**: Vite + React 前端，FastAPI + LangGraph 后端
- **双模式对话**: 简单模式（直连 LLM）和复杂模式（专家协作）
- **组件库**: 100% shadcn/ui 覆盖

### 性能优化
- 减少 DOM 节点数量
- 移除昂贵动画计算
- 统一滚动行为
- 清理调试日志

---

*本记忆文档于 2026-01-23 创建，记录项目重要变更。*
